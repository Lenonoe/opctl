name: delete-resource-group
description: deletes a resource group if it exists
inputs:
  subscriptionId:
    string:
      constraints: { minLength: 1 }
  username:
    string:
      constraints: { format: email }
  password:
    string:
      constraints: { minLength: 1 }
      isSecret: true
  resourceGroupName:
    string:
      constraints: { minLength: 1 }
run:
  container:
    image: microsoft/azure-cli
    cmd:
      - sh
      - -ce
      - |
        echo "logging in to azure"
        azure login -u "$(username)" -p "$(password)"

        echo "setting default subscription"
        azure account set "$(subscriptionId)"

        echo "switching to ARM (azure resource manager) mode"
        azure config mode arm

        echo "deleting resource group"
        azure group delete --name "$(resourceGroupName)" --quiet
