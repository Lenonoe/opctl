name: test-acceptance
description: Runs acceptance tests
inputs:
  - dir: { name: APP_DIR, description: Directory containing the app }
  - netSocket: { name: API_SOCKET, description: Network socket for the API under test, constraints: { port: { number: 80 } } }
run:
  container:
    cmd: [ node_modules/.bin/mocha, --recursive, --reporter=spec, tests/unit ]
    dirs:
      /opt/app: { bind: APP_DIR }
    image: node:7.3
    net:
      - { bind: API_SOCKET }
    workDir: /opt/app
