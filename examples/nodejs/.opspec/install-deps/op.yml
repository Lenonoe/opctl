name: install-deps
description: installs npm packages
inputs:
  app_dir: { dir:, description: directory containing a nodejs app }
  npm_registry_address: { string: }
  npm_registry_path: { string:, isSecret: true }
outputs:
  app_dir: { dir:, description: directory containing a nodejs app }
run:
  container:
    cmd: [ npm, install ]
    envVars:
      NPM_CONFIG_REGISTRY: { value: 'https://$(npm_registry_address)$(npm_registry_path)' }
    dirs:
      /opt/app: { bind: app_dir }
    image: node:7.4
    workDir: /opt/app
