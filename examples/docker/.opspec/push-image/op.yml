name: push-image
description: Pushes a local image to a registry
inputs:
  dockerd_socket: { socket:, description: socket for a docker daemon }
  docker_config: { file:, description: config for docker CLI, isSecret: true }
  image_ref: { string:, description: docker image reference }
run:
  container:
    cmd: [ docker, push, $(image_ref) ]
    files:
      /root/.docker/config.json: { bind: docker_config }
    image: docker:1.13
    sockets:
      /var/run/docker.sock: { bind: dockerd_socket }
