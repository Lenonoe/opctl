name: build-image
description: Builds a docker image
inputs:
  buildContext:
    dir:
      description: context to use for docker build
  dockerSocket:
    socket:
      description: socket for docker daemon
  imageRef:
    string:
      constraints: { format: docker-image-ref }
run:
  container:
    cmd: [ docker, build, -t, $(imageRef), . ]
    dirs:
      /opt/app: { bind: buildContext }
    image: docker:1.13
    sockets:
      /var/run/docker.sock: { bind: dockerSocket }
    workDir: /opt/app
